Ch√†o b·∫°n, ƒë√¢y l√† l·ªùi gi·∫£i chi ti·∫øt cho B√†i t·∫≠p 4.

B√†i t·∫≠p n√†y l√† m·ªôt phi√™n b·∫£n n√¢ng cao c·ªßa B√†i 3. ƒêi·ªÉm kh√°c bi·ªát quan tr·ªçng l√†:

1.  **ƒê·∫ßu v√†o l√† S·ªë Th·ª±c (`double`):** Ch√∫ng ta ph·∫£i d√πng `%lf` ƒë·ªÉ ƒë·ªçc v√† `fabs()` (t·ª´ `math.h`) ƒë·ªÉ so s√°nh c√°c s·ªë th·ª±c (kh√¥ng th·ªÉ d√πng `a == 0` m√† ph·∫£i d√πng `fabs(a) < EPSILON`).
2.  **Xu·∫•t Ra 2 N∆°i:** C·∫ßn ph·∫£i in k·∫øt qu·∫£ ra c·∫£ m√†n h√¨nh (console) v√† ghi v√†o file.

T√¥i s·∫Ω s·ª≠ d·ª•ng file `ptbac2.txt` l√†m file ƒë·∫ßu v√†o, nh∆∞ng s·∫Ω ƒë·ªçc c√°c gi√° tr·ªã c·ªßa n√≥ d∆∞·ªõi d·∫°ng s·ªë th·ª±c (v√≠ d·ª•: `1.0`, `2.0`, `1.0`).

-----

### üìù B√†i 4: Gi·∫£i Ph∆∞∆°ng Tr√¨nh (S·ªë Th·ª±c) v√† Xu·∫•t Ra 2 N∆°i

```cpp
/*
 * Giai Bai tap 4: Doc a, b, c (so thuc) tu file, giai PT bac 2,
 * in ket qua ra man hinh VA ghi vao file khac.
 */
#include <stdio.h>
#include <stdlib.h> // De dung ham exit()
#include <math.h>   // De dung ham sqrt() va fabs()

// Dinh nghia mot so rat nho (Epsilon) de so sanh so thuc
// Thay vi kiem tra "a == 0", ta kiem tra "a co rat gan 0 hay khong"
#define EPSILON 1e-6

/**
 * @brief Giai phuong trinh bac 2 va XUAT KET QUA ra ca man hinh & file
 * @param a He so bac 2 (kieu double)
 * @param b He so bac 1 (kieu double)
 * @param c He so tu do (kieu double)
 * @param fp_out Con tro file (da mo) de ghi ket qua vao
 */
void GiaiVaXuat(double a, double b, double c, FILE* fp_out) {
    // In phuong trinh dang giai
    // (%.2lf la dinh dang cho so double, lay 2 chu so thap phan)
    printf("Dang giai: %.2lfx^2 + %.2lfx + %.2lf = 0\n", a, b, c);
    fprintf(fp_out, "Phuong trinh: %.2lfx^2 + %.2lfx + %.2lf = 0\n", a, b, c);

    // --- TRUONG HOP 1: a ‚âà 0 (Phuong trinh bac nhat) ---
    // Dung fabs(a) < EPSILON de kiem tra a co gan 0 hay khong
    if (fabs(a) < EPSILON) {
        if (fabs(b) < EPSILON) { // b ‚âà 0
            if (fabs(c) < EPSILON) { // c ‚âà 0
                // 0x + 0 = 0
                printf("  -> Ket qua: Phuong trinh co VO SO NGHIEM.\n");
                fprintf(fp_out, "  -> Ket qua: Phuong trinh co VO SO NGHIEM.\n");
            } else { // c != 0
                // 0x + c = 0
                printf("  -> Ket qua: Phuong trinh VO NGHIEM.\n");
                fprintf(fp_out, "  -> Ket qua: Phuong trinh VO NGHIEM.\n");
            }
        } else { // b != 0
            // bx + c = 0
            double x = -c / b;
            printf("  -> Phuong trinh bac nhat co 1 nghiem: x = %.2lf\n", x);
            fprintf(fp_out, "  -> Phuong trinh bac nhat co 1 nghiem: x = %.2lf\n", x);
        }
    }
    // --- TRUONG HOP 2: a != 0 (Phuong trinh bac 2) ---
    else {
        double delta = b * b - 4 * a * c;
        
        if (delta < -EPSILON) { // Delta < 0
            printf("  -> Delta = %.2lf < 0. Phuong trinh VO NGHIEM THUC.\n", delta);
            fprintf(fp_out, "  -> Delta = %.2lf < 0. Phuong trinh VO NGHIEM THUC.\n", delta);
        } else if (fabs(delta) < EPSILON) { // Delta ‚âà 0
            double x = -b / (2 * a);
            printf("  -> Delta = 0. Phuong trinh co NGHIEM KEP: x1 = x2 = %.2lf\n", x);
            fprintf(fp_out, "  -> Delta = 0. Phuong trinh co NGHIEM KEP: x1 = x2 = %.2lf\n", x);
        } else { // Delta > 0
            double x1 = (-b + sqrt(delta)) / (2 * a);
            double x2 = (-b - sqrt(delta)) / (2 * a);
            printf("  -> Delta = %.2lf > 0. Phuong trinh co 2 NGHIEM PHAN BIET:\n", delta);
            fprintf(fp_out, "  -> Delta = %.2lf > 0. Phuong trinh co 2 NGHIEM PHAN BIET:\n", delta);
            printf("     x1 = %.2lf\n", x1);
            fprintf(fp_out, "     x1 = %.2lf\n", x1);
            printf("     x2 = %.2lf\n", x2);
            fprintf(fp_out, "     x2 = %.2lf\n", x2);
        }
    }
    
    // Them dong phan cach
    printf("------------------------------------------\n");
    fprintf(fp_out, "------------------------------------------\n");
}

int main() {
    // Ten file dau vao va dau ra
    // Su dung file ptbac2.txt lam dau vao
    char file_vao[] = "ptbac2.txt"; 
    char file_ra[] = "ketqua_bai4.txt";

    // 1. Khai bao con tro file
    FILE *fp_in, *fp_out;
    double a, b, c; // Su dung kieu double cho so thuc

    // 2. Mo file
    fp_in = fopen(file_vao, "rt"); // Mo file de doc
    fp_out = fopen(file_ra, "wt"); // Mo file de ghi

    // 3. Kiem tra mo file
    if (fp_in == NULL) {
        printf("Loi: Khong the mo file dau vao %s\n", file_vao);
        exit(1);
    }
    if (fp_out == NULL) {
        printf("Loi: Khong the mo file dau ra %s\n", file_ra);
        fclose(fp_in);
        exit(1);
    }

    printf("Bat dau doc file %s va giai phuong trinh...\n\n", file_vao);

    // 4. Doc file va xu ly
    // Su dung %lf (long float) de doc kieu double
    while (fscanf(fp_in, "%lf %lf %lf", &a, &b, &c) == 3) {
        // Voi moi bo 3 so doc duoc, goi ham de giai va xuat ket qua
        GiaiVaXuat(a, b, c, fp_out);
    }

    // 5. Dong ca hai file
    fclose(fp_in);
    fclose(fp_out);

    printf("\nDa giai xong! Ket qua da duoc ghi vao file %s\n", file_ra);

    return 0;
}
```